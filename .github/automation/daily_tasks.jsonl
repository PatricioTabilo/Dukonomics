{"id":"DK-001","priority":"high","type":"chore","file":"Dukonomics.toc","commit":"chore(toc): update interface for WoW 12.0.1","instruction":"Update Dukonomics.toc to target WoW 12.0.1 by setting '## Interface: 120001'. Keep all other metadata and load order unchanged.","acceptance":["Dukonomics.toc contains '## Interface: 120001'","No other TOC entries are removed"],"verify":["manual_toc_review"]}
{"id":"DK-002","priority":"high","type":"refactor","file":"Commands.lua","commit":"refactor(commands): extract RequireDebugMode helper","instruction":"Create a local helper RequireDebugMode() that prints the existing warning and returns false when debug mode is disabled. Reuse it in test-related commands to remove repeated blocks.","acceptance":["RequireDebugMode helper exists","Repeated debug guards are reduced"],"verify":["manual_commands_review"]}
{"id":"DK-003","priority":"high","type":"fix","file":"UI/Formatting.lua","commit":"fix(formatting): support million separators in FormatMoney","instruction":"Update FormatMoney so gold values format correctly for all magnitudes (e.g., 1,500,000g instead of malformed thousands grouping).","acceptance":["Gold formatting works for >= 1,000,000","Existing icon output is preserved"],"verify":["manual_formatting_review"]}
{"id":"DK-004","priority":"medium","type":"fix","file":"UI/Formatting.lua","commit":"fix(formatting): handle negative copper values","instruction":"Enhance FormatMoney to support negative copper inputs while preserving current positive formatting behavior.","acceptance":["Negative values display with clear sign","Positive values unchanged"],"verify":["manual_formatting_review"]}
{"id":"DK-005","priority":"medium","type":"fix","file":"Core.lua","commit":"fix(core): centralize addon version metadata","instruction":"Define Dukonomics.VERSION during initialization using addon metadata APIs and reuse it for welcome messaging instead of hardcoded fallback strings where possible.","acceptance":["Dukonomics.VERSION is set once","Welcome message uses shared version value"],"verify":["manual_core_review"]}
{"id":"DK-006","priority":"medium","type":"feat","file":"Commands.lua","commit":"feat(commands): add /duk version command","instruction":"Add '/duk version' command that prints the current addon version from Dukonomics.VERSION or metadata fallback.","acceptance":["/duk version command exists","Help output includes version command"],"verify":["manual_commands_review"]}
{"id":"DK-007","priority":"medium","type":"refactor","file":"data/ConfigRepository.lua","commit":"refactor(config): deep-merge default config tables","instruction":"Improve default config initialization to deep-merge nested defaults instead of shallow-copying only one table level.","acceptance":["Nested defaults are populated safely","Existing saved values are preserved"],"verify":["manual_config_review"]}
{"id":"DK-008","priority":"medium","type":"feat","file":"testing/TestRunner.lua","commit":"feat(testing): add pass/fail summary counters","instruction":"Track total, passed, and failed test counts in RunTests and print a concise summary at the end.","acceptance":["Summary includes totals","Existing test flow still runs"],"verify":["manual_testrunner_review"]}
{"id":"DK-009","priority":"low","type":"docs","file":"README.md","commit":"docs(readme): add compatibility note for WoW version","instruction":"Add a small compatibility section in README indicating current intended WoW client version support.","acceptance":["README includes compatibility note","Formatting remains valid markdown"],"verify":["manual_readme_review"]}
{"id":"DK-010","priority":"low","type":"chore","file":"core/Logger.lua","commit":"chore(logger): add warn method for non-critical warnings","instruction":"Add Dukonomics.Logger.warn(msg) with a distinct prefix/color for warning-level messages while keeping current print/debug behavior.","acceptance":["warn method exists","No regressions in print/debug methods"],"verify":["manual_logger_review"]}
{"id": "DK-011", "priority": "high", "type": "fix", "file": "UI/components/FilterBar.lua", "commit": "fix(filters): widen character dropdown for long name-realm entries", "instruction": "Increase the character filter dropdown width so long 'Character-Realm' combinations are fully readable without clipping in common UI scales.", "acceptance": ["Character dropdown width is larger than current 140px menu rows", "Long character-realm labels are no longer visually truncated in most cases"], "verify": ["manual_ui_filter_review"]}
{"id": "DK-012", "priority": "high", "type": "feat", "file": "UI/components/FilterBar.lua", "commit": "feat(filters): add scrollable character dropdown list", "instruction": "Make the character filter dropdown scrollable so users can browse all characters when the list exceeds visible space.", "acceptance": ["Character dropdown has vertical scrolling for long lists", "All characters remain selectable with mouse"], "verify": ["manual_ui_filter_review"]}
{"id": "DK-013", "priority": "high", "type": "fix", "file": "UI/components/FilterBar.lua", "commit": "fix(filters): close all open menus when main frame hides", "instruction": "Ensure type, time, status, and character dropdown menus are forcibly hidden when Dukonomics main window closes.", "acceptance": ["No filter dropdown stays open after closing main window", "Reopening main window shows clean dropdown state"], "verify": ["manual_ui_filter_review"]}
{"id": "DK-014", "priority": "medium", "type": "fix", "file": "UI/components/FilterBar.lua", "commit": "fix(filters): guard dropdown anchoring near screen edges", "instruction": "When opening filter dropdowns near screen boundaries, reposition menus to stay on-screen and avoid clipping off-screen.", "acceptance": ["Dropdown menus stay visible within screen bounds", "Anchoring still aligns close to trigger button"], "verify": ["manual_ui_filter_review"]}
{"id": "DK-015", "priority": "medium", "type": "refactor", "file": "UI/components/FilterBar.lua", "commit": "refactor(filters): centralize dropdown open-close state management", "instruction": "Create shared helpers to open one dropdown at a time and close the others to reduce duplicated state flags and inconsistent behavior.", "acceptance": ["Single shared dropdown state helper exists", "Opening one menu closes any other open menu"], "verify": ["manual_ui_filter_review"]}
{"id": "DK-016", "priority": "medium", "type": "fix", "file": "UI/components/FilterBar.lua", "commit": "fix(filters): truncate button label with count for multi-character selections", "instruction": "Improve character filter button text logic so long names do not overflow button width; use concise text like '3 Selected' when needed.", "acceptance": ["Button text never overflows its frame", "Single selection still shows readable character name when it fits"], "verify": ["manual_ui_filter_review"]}
{"id": "DK-017", "priority": "medium", "type": "refactor", "file": "UI/MainFrame.lua", "commit": "refactor(mainframe): extract character match helper for filter pass", "instruction": "Extract repeated character filter matching logic used in postings and purchases loops into a local helper to reduce duplication and bugs.", "acceptance": ["Shared helper replaces duplicated character-match blocks", "Filtering behavior remains unchanged"], "verify": ["manual_code_review"]}
{"id": "DK-018", "priority": "medium", "type": "fix", "file": "UI/components/FilterBar.lua", "commit": "fix(filters): correct cached characters sync field typo", "instruction": "Fix cached filter sync bug where code writes to filters.character instead of filters.characters during initialization.", "acceptance": ["Initialization sync uses filters.characters consistently", "Cached character selections restore correctly"], "verify": ["manual_ui_filter_review"]}
{"id": "DK-019", "priority": "low", "type": "perf", "file": "UI/MainFrame.lua", "commit": "perf(mainframe): remove repeated datastore lookups in filter loops", "instruction": "Avoid calling Dukonomics.Data.GetDataStore() multiple times inside GetFilteredData; reuse the already-fetched datastore reference.", "acceptance": ["Only one datastore fetch is used per refresh", "No behavior changes in filtering output"], "verify": ["manual_code_review"]}
{"id": "DK-020", "priority": "low", "type": "fix", "file": "UI/components/FilterBar.lua", "commit": "fix(filters): close dropdowns on escape key", "instruction": "Support closing any open filter dropdown with ESC key even before the main frame closes.", "acceptance": ["ESC closes open dropdown menu first", "Main frame close behavior remains intact"], "verify": ["manual_ui_filter_review"]}
{"id": "DK-021", "priority": "low", "type": "docs", "file": "README.md", "commit": "docs(readme): add filter UX notes and known limits", "instruction": "Document filter behavior (multi-select characters, cached filters, dropdown closing expectations) in README for contributors/testers.", "acceptance": ["README contains filter UX section", "Notes reflect current implemented behavior"], "verify": ["manual_readme_review"]}
{"id": "DK-022", "priority": "high", "type": "fix", "file": "handlers/MailHandler.lua", "commit": "fix(mail): match expired caged pets using species id fallback", "instruction": "When processing expired auction mails for caged battle pets, support matching postings even if posting name is generic (e.g. 'Pet Cage'/'Caja de mascota') and mail subject uses species name. Implement robust fallback matching by battle pet species ID from links while preserving current name-first behavior.", "acceptance": ["Expired caged pet mail marks the correct active posting as expired even when names differ", "Non-pet expiration matching continues to work unchanged", "No false positives when multiple active postings exist"], "verify": ["manual_mail_expired_pet_scenario", "manual_regression_expired_non_pet"]}
